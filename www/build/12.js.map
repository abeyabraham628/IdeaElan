{"version":3,"sources":["../../src/pages/apply-leave/apply-leave.module.ts","../../src/pages/apply-leave/apply-leave.ts"],"names":[],"mappings":"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","file":"12.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ApplyLeavePage } from './apply-leave';\n\n\n\n\n@NgModule({\n  declarations: [\n    ApplyLeavePage,\n    \n  ],\n  imports: [\n    IonicPageModule.forChild(ApplyLeavePage),\n    ],\n\n})\nexport class ApplyLeavePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/apply-leave/apply-leave.module.ts","\n\n\n\nimport { leaves } from './../../providers/user-leaves';\nimport { Component, Type } from '@angular/core';\nimport { IonicPage, NavController, NavParams,AlertController,ModalController } from 'ionic-angular';\nimport { DatePicker } from '@ionic-native/date-picker';\nimport { AngularFireDatabase,AngularFireList } from '@angular/fire/database';\nimport { DatePipe } from '@angular/common';\nimport { AngularFireAuth } from '@angular/fire/auth';\n\nimport { CalendarModal, CalendarModalOptions, DayConfig, CalendarResult,CalendarComponentOptions } from \"ion2-calendar\";\n\n\n\n/**\n * Generated class for the ApplyLeavePage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-apply-leave',\n  templateUrl: 'apply-leave.html',\n})\nexport class ApplyLeavePage{\n \nfromDate:string;\ntoDate:string;\nleaveList:AngularFireList<any>\nleave={} as leaves\nsickRemaining:number;\ncasualRemaining:number;\ncurrentMonthLeave:number=0;\n\ndateMulti: string[];\ntype: 'string'; // 'string' | 'js-date' | 'moment' | 'time' | 'object'\n\n\n\n\n\n  constructor(public navCtrl: NavController, \n            public navParams: NavParams,\n            private datePicker:DatePicker, \n            private firebase:AngularFireDatabase,\n            private datepipe:DatePipe,\n            private afauth:AngularFireAuth,\n            private alert:AlertController,\n            private modalCtrl:ModalController,\n           ) {}\n\n          \n           openCalendar() {\n           \n            const options: CalendarComponentOptions = {\n              pickMode: 'multi',\n              showAdjacentMonthDay:false,\n               disableWeeks: [0, 6],\n             };\n\n            let myCalendar =  this.modalCtrl.create(CalendarModal, {\n              options: options,\n            });\n         \n            myCalendar.present();\n            \n              myCalendar.onDidDismiss((date: CalendarResult[], type: string) => {\n                \n                date.sort(function (a, b) {\n                return a.time - b.time;\n                \n              });\n                \n              let month=[]\n                date.forEach(function(value){\n                 month.push(value.months)\n              })\n              \n              const uniqeMonths = month.filter((elem, i, arr) => {\n                if (arr.indexOf(elem) === i) {\n                  return elem\n                }\n              })\n              let month1=[]\n              let month2=[];\n             let flag:boolean=true\n             \n              for(let i=0;i<uniqeMonths.length;i++){\n                date.forEach(function(value){\n                  if(value.months==uniqeMonths[i]){\n                    if(flag)\n                    month1.push({'date':value.string})\n                    else\n                    month2.push({'date':value.string})\n                  }\n                })// end of for each\n                  flag=false\n              }//end of loop\n                console.log(month1)\n             })//end of calendar dismiss\n            \n          }//end of open calendar function\n        \n  ionViewDidLoad() {\n    this.getRamainingLeaves()\n  }\n\n  dispdate(type:String){\n    this.datePicker.show({\n    date: new Date(),\n    mode: 'date',\n    androidTheme: this.datePicker.ANDROID_THEMES.THEME_HOLO_LIGHT\n  }).then(\n    date=>{\n     if(type===\"from\"){\n       this.leave.dateFrom = new Date(date).toLocaleDateString()\n     }\n     else{\n       this.leave.dateTo= new Date(date).toLocaleDateString()\n     }\n   },err => console.log('Error occurred while getting date: ', err)\n\n   );\n  }//end of date function\n\n \n\n  \n  submitLeaveRequest(){\n      let uid=this.afauth.auth.currentUser.uid;\n      this.leave.status=\"pending\";\n      \n     if(new Date().getHours()<9){\n        const alert = this.alert.create({\n          title: 'Restricted',\n          subTitle: 'Unable to process your request at this moment. Please contact your team leader.!',\n          buttons: ['OK']\n          });\n        alert.present();\n    }\n      \n    else{\n      let $key=this.generateKey(this.leave.dateFrom)\n      this.leave.count=this.find(this.leave.dateFrom,this.leave.dateTo)\n      this.firebase.list(`EmployeeLeaves/${uid}/Leaves/${$key}`).push(this.leave);//inserting the details of leaves\n     \n    }//end of if else \n        \n       \n    }//end os submit leave request function\n\n\n  pastLeaves:any[]\n  \n   getPastLeaves(){\n    \n    this.firebase.list(`EmployeeLeaves/${this.afauth.auth.currentUser.uid}/Leaves`).snapshotChanges().subscribe(\n      list=>{\n        this.pastLeaves=list.map(item=>{\n          return{\n            $key:item.key,\n            ...item.payload.val()\n          };\n          });\n      }); \n}//end of function\n\nasync getRamainingLeaves(){\n  let firebase=this.firebase;\n  let date:any;\n  let year=new Date().getFullYear();\n    if(new Date().getMonth()+1<10){\n       date=\"0\"+(new Date().getMonth()+1)+\"\"+new Date().getFullYear()\n    }\n    else{ \n      date=new Date().getMonth()+1+\"\"+new Date().getFullYear()\n    }\n    await firebase.database.ref(`EmployeeLeaves/FcXUquFxnfalG9DzoNi4X0CnRoG2/AvailableLeaves/${year}`).on('value',(snapshot)=>{\n      this.sickRemaining=snapshot.child('sick').val()\n      this.casualRemaining=snapshot.child('casual').val()\n      firebase.database.ref(`EmployeeLeaves/FcXUquFxnfalG9DzoNi4X0CnRoG2/MonthlyLeaves/${date}`).on('value',(snapshot)=>{\n          this.currentMonthLeave=snapshot.val();\n      })\n\n    })//end of database ref*/\n\n\n}\n    \n  find(from?,to?){\n  \n    \n    let dateFrom:any =from.split('/');\n    let dateTo:any=to.split('/');\n    let x=dateFrom[1]+dateFrom[2]\n    let y=dateTo[1]+dateTo[2]\n\n\n    if(dateFrom[1]!=dateTo[1]){\n        \n\n      let lastDayMonth1=new Date(dateFrom[2],dateFrom[1],0).getDate()// gethte last day of the month\n      let x=lastDayMonth1+dateFrom[0]\n      let monthOneCount=lastDayMonth1-dateFrom[0]+1\n      let firstDayMonth2=new Date(dateTo[2],dateTo[1],1).getDate()\n      let monthTwoCount=firstDayMonth2-dateTo[0]+1\n        \n     \n      return(monthOneCount+this.currentMonthLeave)\n    }\n    else\n        return ((dateTo[0] - dateFrom[0]+1)+ this.currentMonthLeave)\n }\n \n generateKey(date:string){\n    let key=date.split('/');\n   return(key[1]+key[2])\n }\n\n\n \n    \n\n  \n\n}// end of class\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/apply-leave/apply-leave.ts"],"sourceRoot":""}